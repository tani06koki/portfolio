<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Koki Taniguchi">

<title>Evaluating the Impact of Agricultural Sector Developments on Poverty Reduction in developing countries in Asia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="finalassignment script_files/libs/clipboard/clipboard.min.js"></script>
<script src="finalassignment script_files/libs/quarto-html/quarto.js"></script>
<script src="finalassignment script_files/libs/quarto-html/popper.min.js"></script>
<script src="finalassignment script_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="finalassignment script_files/libs/quarto-html/anchor.min.js"></script>
<link href="finalassignment script_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="finalassignment script_files/libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="finalassignment script_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="finalassignment script_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="finalassignment script_files/libs/bootstrap/bootstrap-e9da56d75d2e665d5c62fdbc3e7753e2.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Evaluating the Impact of Agricultural Sector Developments on Poverty Reduction in developing countries in Asia</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Koki Taniguchi </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">Background</h3>
<p>Many developing countries in Asia are heavily reliant on the <strong>agricultural sector</strong> as the primary source of livelihood. A significant proportion of the <strong>poor population</strong> lives in these areas, where economic activities are centered around agriculture, forestry, and fishing. Despite global efforts to reduce poverty, disparities persist, especially in rural communities. Investment in the <strong>primary sector</strong> has the potential to address poverty by improving agricultural productivity, increasing employment, and generating income. This study explores the relationship between <strong>sector-specific investments</strong> and poverty reduction to better understand the role agriculture plays in alleviating poverty in regional areas.</p>
</section>
<section id="research-question" class="level3">
<h3 class="anchored" data-anchor-id="research-question">Research Question</h3>
<p>How does development in the agricultural sector influence poverty reduction in rural areas where the primary sector dominates economic activity?</p>
</section>
<section id="research-objective" class="level3">
<h3 class="anchored" data-anchor-id="research-objective">Research Objective</h3>
<ul>
<li><p><strong>Analyze</strong> the relationship between agricultural development and poverty rates in developing countries.</p></li>
<li><p><strong>Identify</strong> the extent to which development in sectors can reduce disparities in poverty.</p></li>
<li><p><strong>Compare</strong> the impact of agricultural developments with developments in other sectors (e.g., manufacturing, services) to assess their effectiveness in poverty reduction.</p></li>
</ul>
</section>
<section id="research-hypothesis" class="level3">
<h3 class="anchored" data-anchor-id="research-hypothesis">Research Hypothesis</h3>
<p><strong>H₀ (Null Hypothesis)</strong>: Development in the agricultural sector has no significant impact on poverty reduction in rural areas.<br>
<strong>H₁ (Alternative Hypothesis)</strong>: Development in the agricultural sector significantly reduces poverty levels in rural areas where the primary sector is the dominant industry.</p>
</section>
<section id="variables-used" class="level3">
<h3 class="anchored" data-anchor-id="variables-used">Variables Used</h3>
<p>Variables:</p>
<ul>
<li><p><strong>Pov_headocount</strong>: Poverty headcount (Dependent Variable)</p></li>
<li><p><strong>country</strong>: Country name</p></li>
<li><p><strong>Year</strong>: Reporting year</p></li>
<li><p><strong>Gini</strong>: Gini Index</p></li>
<li><p><strong>GDP</strong>: Gross Domestic Production</p></li>
<li><p><strong>GDPperCapita</strong>: GDP per capita</p></li>
<li><p><strong>Inflation:</strong> Annual Inflation rate</p></li>
<li><p><strong>Unemployment_Rate:</strong> Unemployment Rate</p></li>
<li><p><strong>Employment_agriculture:</strong> Percentage working in agriculture sector</p></li>
<li><p><strong>Employment_industry:</strong> Percentage working in industrial sector</p></li>
<li><p><strong>Employment_service:</strong> Percentage working in service sector</p></li>
<li><p><strong>GDP_Agriculture_percent:</strong> GDP percentage produced in agricultural sector</p></li>
<li><p><strong>GDP_Industry_percent:</strong> GDP percentage produced in Industrial sector</p></li>
<li><p><strong>GDP_Manufacture_percent:</strong> GDP percentage produced in Manufacture sector</p></li>
<li><p><strong>GDP_Service_percent:</strong> GDP percentage produced in service sector</p></li>
<li><p><strong>GDP_Agriculture_LF:</strong> GDP produced in agricultural sector divided by number of employee</p></li>
<li><p><strong>GDP_Industry_LF:</strong> GDP produced in Industrial sector divided by number of employee</p></li>
<li><p><strong>GDP_Manufacture_LF:</strong> GDP produced in manufacture sector divided by number of employee</p></li>
<li><p><strong>GDP_Service_LF:</strong> GDP produced in service sector divided by number of employee</p></li>
</ul>
</section>
</section>
<section id="initial-data-preprocessing" class="level1">
<h1><strong>Initial Data Preprocessing</strong></h1>
<section id="data-collection-and-integration" class="level2">
<h2 class="anchored" data-anchor-id="data-collection-and-integration"><strong>1. Data collection and integration</strong></h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Import</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pip <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/pip.csv"</span>) </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>LF <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/Employment by sector (%) .csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Gdp <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/ea44776a-6dd7-4f98-8db0-eb7b5ba085bb_Data.csv"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>GDPperCapita <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/API_NY.GDP.PCAP.CD_DS2_en_csv_v2_31681.csv"</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Industry_gdp <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/API_NV.IND.TOTL.ZS_DS2_en_csv_v2_10685.csv"</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Service_gdp <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/API_NV.SRV.TOTL.ZS_DS2_en_csv_v2_2251.csv"</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip =</span> <span class="dv">4</span>) </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>Manufacture_gdp  <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/API_NV.IND.MANF.ZS_DS2_en_csv_v2_116.csv"</span>, </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>Agriculture_gdp <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/API_NV.AGR.TOTL.ZS_DS2_en_csv_v2_8070.csv"</span>, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>Inflation <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/API_FP.CPI.TOTL.ZG_DS2_en_csv_v2_31752.csv"</span>, </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip =</span> <span class="dv">3</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>Unemployment <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/API_SL.UEM.TOTL.ZS_DS2_en_csv_v2_31678.csv"</span>, </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">skip =</span> <span class="dv">3</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="do">### Data Cleaning</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Poverty Data</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>poverty <span class="ot">=</span>  pip <span class="sc">%&gt;%</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(reporting_level  <span class="sc">==</span> <span class="st">"national"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.character</span>(reporting_year),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">country =</span> <span class="fu">as.factor</span>(country_name),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">Pov_headcount =</span> <span class="fu">as.numeric</span>(headcount),</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">Gini =</span> <span class="fu">as.numeric</span>(gini)) <span class="sc">%&gt;%</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, year, Pov_headcount, Gini)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Labor Force</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>Labor <span class="ot">=</span> LF <span class="sc">%&gt;%</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Indicator =</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Indicator Name</span><span class="st">`</span>),</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">Country =</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Country Name</span><span class="st">`</span>),</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">Rate =</span> <span class="fu">as.numeric</span>(Value),</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">Disaggregation =</span> <span class="fu">as.factor</span>(<span class="st">`</span><span class="at">Disaggregation</span><span class="st">`</span>)) </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Labor Force in agriculrural sector</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>agriculture_LF <span class="ot">=</span> Labor <span class="sc">%&gt;%</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Employment in agriculture (% of total employment) (modeled ILO estimate)"</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Employment_agriculture =</span> Rate) <span class="sc">%&gt;%</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Year, Employment_agriculture) <span class="sc">%&gt;%</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.character</span>(year))</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Labor Force in service sector</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>service_LF <span class="ot">=</span> Labor <span class="sc">%&gt;%</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Employment in services (% of total employment) (modeled ILO estimate)"</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Employment_service =</span> Rate) <span class="sc">%&gt;%</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Year, Employment_service) <span class="sc">%&gt;%</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.character</span>(year))</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Labor Force in Industrial sector</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>industry_LF <span class="ot">=</span> Labor <span class="sc">%&gt;%</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Employment in industry (% of total employment) (modeled ILO estimate)"</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Employment_industry =</span> Rate) <span class="sc">%&gt;%</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Country, Year, Employment_industry) <span class="sc">%&gt;%</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>,</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.character</span>(year))</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for GDP Data</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>gdp <span class="ot">=</span> Gdp <span class="sc">%&gt;%</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"19"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"20"</span>),  </span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,  </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"GDP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">substring</span>(year, <span class="dv">0</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP =</span> <span class="fu">as.numeric</span>(GDP))</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for GDP per Capita Data</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>gdp_capita <span class="ot">=</span> GDPperCapita <span class="sc">%&gt;%</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"19"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"20"</span>),  </span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,  </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"GDPperCapita"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>)</span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Industrial GDP Data</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>industry <span class="ot">=</span> Industry_gdp <span class="sc">%&gt;%</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"19"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"20"</span>),  </span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">"year"</span>,  </span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">"GDP_Industry_percent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>) </span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Agricultural GDP Data</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>agriculture <span class="ot">=</span> Agriculture_gdp <span class="sc">%&gt;%</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"19"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"20"</span>),  </span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,  </span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"GDP_Agriculture_percent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>) </span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Service GDP Data</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>service <span class="ot">=</span> Service_gdp <span class="sc">%&gt;%</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"19"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"20"</span>),  </span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,  </span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"GDP_Service_percent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>) </span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Manufacture GDP Data</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>manufacture <span class="ot">=</span> Manufacture_gdp <span class="sc">%&gt;%</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"19"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"20"</span>),  </span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,  </span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"GDP_Manufacture_percent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>) </span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Inflation Data</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>inflation <span class="ot">&lt;-</span> Inflation <span class="sc">%&gt;%</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"19"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"20"</span>),  </span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,  </span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Inflation"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Inflation =</span> <span class="fu">as.numeric</span>(Inflation)) <span class="sc">%&gt;%</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>) </span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Cleaning for Unemployment GDP Data</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>unemployment <span class="ot">=</span> Unemployment <span class="sc">%&gt;%</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"19"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"20"</span>),  </span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"year"</span>,  </span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Unemployment_Rate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="dv">1</span>) </span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a><span class="do">### Join All data</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a>join <span class="ot">=</span> <span class="fu">full_join</span>(poverty, gdp, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(gdp_capita, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(inflation, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(unemployment, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(agriculture_LF, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(service_LF, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(industry_LF, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(industry, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(service, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(agriculture, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(manufacture, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_agriculture =</span> GDP <span class="sc">*</span> GDP_Agriculture_percent <span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_manufacture =</span> GDP <span class="sc">*</span> GDP_Manufacture_percent <span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_industrial =</span> GDP <span class="sc">*</span> GDP_Industry_percent <span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_service =</span> GDP <span class="sc">*</span> GDP_Service_percent <span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">GDP_agriculture_LF =</span> </span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>           GDP <span class="sc">*</span> GDP_Agriculture_percent <span class="sc">/</span><span class="dv">100</span> <span class="sc">*</span> Employment_agriculture<span class="sc">/</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_industrial_LF =</span> </span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>           GDP <span class="sc">*</span> GDP_Industry_percent <span class="sc">/</span><span class="dv">100</span> <span class="sc">*</span> Employment_industry <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP_service_LF =</span> </span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>           GDP <span class="sc">*</span> GDP_Service_percent <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> Employment_service <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(GDP_agriculture, GDP_manufacture, GDP_industrial, GDP_service))</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Target Countries</span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a>south_southeast_asia <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Bangladesh"</span>, </span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Bhutan"</span>, </span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"India"</span>, </span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Maldives"</span>, </span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Nepal"</span>, </span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Pakistan"</span>, </span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Sri Lanka"</span>, </span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Brunei"</span>, </span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Indonesia"</span>,</span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Laos"</span>, </span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Myanmar"</span>, </span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Philippines"</span>, </span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Thailand"</span>, </span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"Vietnam"</span>)</span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a><span class="co"># cambodia has no povertydata</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a><span class="co"># filter by Poor Countries in south and southeast asia and after 2010</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">=</span> join <span class="sc">%&gt;%</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> south_southeast_asia) <span class="sc">%&gt;%</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Pov_headcount <span class="sc">&gt;=</span> <span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="dependent-variable-poverty-headcount" class="level3">
<h3 class="anchored" data-anchor-id="dependent-variable-poverty-headcount"><strong>Dependent Variable: Poverty Headcount</strong></h3>
<p>The dependent variable we use is `Pov_headcount` variable while struggling with the missing data limitation that reaches to 61%. Data is obtained from World Bank.</p>
</section>
</section>
<section id="missing-values" class="level2">
<h2 class="anchored" data-anchor-id="missing-values"><strong>2. Missing Values</strong></h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the percentage amount of NA relative to the dataset population</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>percent_na <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(final_data)) <span class="sc">/</span> (<span class="fu">nrow</span>(final_data) <span class="sc">*</span> <span class="fu">ncol</span>(final_data)) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the total NA</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>full_na <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(final_data))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize the missing values</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(final_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="summary-statistics-for-each-variable" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics-for-each-variable">Summary Statistics for each variable</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the summary</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">describe</span>(final_data),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"*Full dataset summary statistics for each variable*"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Full dataset summary statistics for each variable</em></caption>
<colgroup>
<col style="width: 14%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">vars</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">trimmed</th>
<th style="text-align: right;">mad</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">range</th>
<th style="text-align: right;">skew</th>
<th style="text-align: right;">kurtosis</th>
<th style="text-align: right;">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">country*</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">6.617000e+00</td>
<td style="text-align: right;">3.375700e+00</td>
<td style="text-align: right;">7.000000e+00</td>
<td style="text-align: right;">6.734500e+00</td>
<td style="text-align: right;">4.447800e+00</td>
<td style="text-align: right;">1.000000e+00</td>
<td style="text-align: right;">1.100000e+01</td>
<td style="text-align: right;">1.000000e+01</td>
<td style="text-align: right;">-0.1031</td>
<td style="text-align: right;">-1.4722</td>
<td style="text-align: right;">2.843000e-01</td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">2.005908e+03</td>
<td style="text-align: right;">1.127890e+01</td>
<td style="text-align: right;">2.008000e+03</td>
<td style="text-align: right;">2.006673e+03</td>
<td style="text-align: right;">1.186080e+01</td>
<td style="text-align: right;">1.977000e+03</td>
<td style="text-align: right;">2.023000e+03</td>
<td style="text-align: right;">4.600000e+01</td>
<td style="text-align: right;">-0.5047</td>
<td style="text-align: right;">-0.7334</td>
<td style="text-align: right;">9.499000e-01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pov_headcount</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">1.742000e-01</td>
<td style="text-align: right;">1.871000e-01</td>
<td style="text-align: right;">1.162000e-01</td>
<td style="text-align: right;">1.408000e-01</td>
<td style="text-align: right;">1.399000e-01</td>
<td style="text-align: right;">0.000000e+00</td>
<td style="text-align: right;">7.457000e-01</td>
<td style="text-align: right;">7.457000e-01</td>
<td style="text-align: right;">1.3874</td>
<td style="text-align: right;">1.1590</td>
<td style="text-align: right;">1.580000e-02</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gini</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">3.622000e-01</td>
<td style="text-align: right;">5.160000e-02</td>
<td style="text-align: right;">3.550000e-01</td>
<td style="text-align: right;">3.600000e-01</td>
<td style="text-align: right;">5.860000e-02</td>
<td style="text-align: right;">2.588000e-01</td>
<td style="text-align: right;">4.786000e-01</td>
<td style="text-align: right;">2.198000e-01</td>
<td style="text-align: right;">0.3165</td>
<td style="text-align: right;">-0.7893</td>
<td style="text-align: right;">4.300000e-03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">7.084909e+11</td>
<td style="text-align: right;">8.512699e+11</td>
<td style="text-align: right;">3.940874e+11</td>
<td style="text-align: right;">5.463774e+11</td>
<td style="text-align: right;">4.863437e+11</td>
<td style="text-align: right;">2.591358e+09</td>
<td style="text-align: right;">3.167271e+12</td>
<td style="text-align: right;">3.164679e+12</td>
<td style="text-align: right;">1.5087</td>
<td style="text-align: right;">1.1710</td>
<td style="text-align: right;">1.169309e+11</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDPperCapita</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">2.318852e+03</td>
<td style="text-align: right;">2.045358e+03</td>
<td style="text-align: right;">1.659888e+03</td>
<td style="text-align: right;">1.997107e+03</td>
<td style="text-align: right;">1.587454e+03</td>
<td style="text-align: right;">1.505814e+02</td>
<td style="text-align: right;">1.134986e+04</td>
<td style="text-align: right;">1.119928e+04</td>
<td style="text-align: right;">1.5341</td>
<td style="text-align: right;">2.7789</td>
<td style="text-align: right;">1.722502e+02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inflation</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">6.290800e+00</td>
<td style="text-align: right;">6.120700e+00</td>
<td style="text-align: right;">5.134200e+00</td>
<td style="text-align: right;">5.564500e+00</td>
<td style="text-align: right;">3.521300e+00</td>
<td style="text-align: right;">-9.004000e-01</td>
<td style="text-align: right;">5.845100e+01</td>
<td style="text-align: right;">5.935150e+01</td>
<td style="text-align: right;">4.8127</td>
<td style="text-align: right;">36.1933</td>
<td style="text-align: right;">5.192000e-01</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployment_Rate</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">122</td>
<td style="text-align: right;">4.116000e+00</td>
<td style="text-align: right;">2.787300e+00</td>
<td style="text-align: right;">3.770000e+00</td>
<td style="text-align: right;">3.865500e+00</td>
<td style="text-align: right;">3.155700e+00</td>
<td style="text-align: right;">2.490000e-01</td>
<td style="text-align: right;">1.227000e+01</td>
<td style="text-align: right;">1.202100e+01</td>
<td style="text-align: right;">0.7314</td>
<td style="text-align: right;">0.0532</td>
<td style="text-align: right;">2.523000e-01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Employment_agriculture</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">4.098490e+01</td>
<td style="text-align: right;">1.187780e+01</td>
<td style="text-align: right;">4.129500e+01</td>
<td style="text-align: right;">4.047470e+01</td>
<td style="text-align: right;">1.005350e+01</td>
<td style="text-align: right;">7.859000e+00</td>
<td style="text-align: right;">7.589700e+01</td>
<td style="text-align: right;">6.803800e+01</td>
<td style="text-align: right;">0.2652</td>
<td style="text-align: right;">0.8369</td>
<td style="text-align: right;">1.079800e+00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Employment_service</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">3.958990e+01</td>
<td style="text-align: right;">1.009890e+01</td>
<td style="text-align: right;">3.866600e+01</td>
<td style="text-align: right;">3.936000e+01</td>
<td style="text-align: right;">9.187700e+00</td>
<td style="text-align: right;">1.412800e+01</td>
<td style="text-align: right;">6.966800e+01</td>
<td style="text-align: right;">5.554000e+01</td>
<td style="text-align: right;">0.2788</td>
<td style="text-align: right;">0.6030</td>
<td style="text-align: right;">9.181000e-01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Employment_industry</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">1.942510e+01</td>
<td style="text-align: right;">4.190300e+00</td>
<td style="text-align: right;">1.999000e+01</td>
<td style="text-align: right;">1.969720e+01</td>
<td style="text-align: right;">3.785100e+00</td>
<td style="text-align: right;">6.658000e+00</td>
<td style="text-align: right;">2.760700e+01</td>
<td style="text-align: right;">2.094900e+01</td>
<td style="text-align: right;">-0.7010</td>
<td style="text-align: right;">0.6118</td>
<td style="text-align: right;">3.809000e-01</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_Industry_percent</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">3.227850e+01</td>
<td style="text-align: right;">8.840300e+00</td>
<td style="text-align: right;">3.419450e+01</td>
<td style="text-align: right;">3.265090e+01</td>
<td style="text-align: right;">8.170100e+00</td>
<td style="text-align: right;">9.620200e+00</td>
<td style="text-align: right;">4.806070e+01</td>
<td style="text-align: right;">3.844050e+01</td>
<td style="text-align: right;">-0.4293</td>
<td style="text-align: right;">-0.4676</td>
<td style="text-align: right;">7.471000e-01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Service_percent</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">4.821440e+01</td>
<td style="text-align: right;">7.968000e+00</td>
<td style="text-align: right;">4.791150e+01</td>
<td style="text-align: right;">4.804930e+01</td>
<td style="text-align: right;">8.441100e+00</td>
<td style="text-align: right;">2.481090e+01</td>
<td style="text-align: right;">7.792650e+01</td>
<td style="text-align: right;">5.311560e+01</td>
<td style="text-align: right;">0.3573</td>
<td style="text-align: right;">0.9427</td>
<td style="text-align: right;">6.832000e-01</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_Agriculture_percent</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">1.669460e+01</td>
<td style="text-align: right;">7.814700e+00</td>
<td style="text-align: right;">1.440880e+01</td>
<td style="text-align: right;">1.572410e+01</td>
<td style="text-align: right;">6.360100e+00</td>
<td style="text-align: right;">4.494000e+00</td>
<td style="text-align: right;">5.729880e+01</td>
<td style="text-align: right;">5.280480e+01</td>
<td style="text-align: right;">1.5928</td>
<td style="text-align: right;">4.3566</td>
<td style="text-align: right;">6.605000e-01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Manufacture_percent</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">135</td>
<td style="text-align: right;">1.942750e+01</td>
<td style="text-align: right;">7.044400e+00</td>
<td style="text-align: right;">1.986320e+01</td>
<td style="text-align: right;">1.981300e+01</td>
<td style="text-align: right;">8.133800e+00</td>
<td style="text-align: right;">2.078300e+00</td>
<td style="text-align: right;">3.195330e+01</td>
<td style="text-align: right;">2.987490e+01</td>
<td style="text-align: right;">-0.3383</td>
<td style="text-align: right;">-0.5710</td>
<td style="text-align: right;">6.063000e-01</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_agriculture_LF</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">4.213256e+10</td>
<td style="text-align: right;">6.467839e+10</td>
<td style="text-align: right;">1.352689e+10</td>
<td style="text-align: right;">2.944007e+10</td>
<td style="text-align: right;">1.556342e+10</td>
<td style="text-align: right;">2.022373e+07</td>
<td style="text-align: right;">2.425385e+11</td>
<td style="text-align: right;">2.425183e+11</td>
<td style="text-align: right;">1.9025</td>
<td style="text-align: right;">2.2035</td>
<td style="text-align: right;">9.335521e+09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_industrial_LF</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">5.354041e+10</td>
<td style="text-align: right;">5.871016e+10</td>
<td style="text-align: right;">3.429307e+10</td>
<td style="text-align: right;">4.574000e+10</td>
<td style="text-align: right;">4.449273e+10</td>
<td style="text-align: right;">1.181289e+08</td>
<td style="text-align: right;">2.051238e+11</td>
<td style="text-align: right;">2.050057e+11</td>
<td style="text-align: right;">1.1023</td>
<td style="text-align: right;">-0.0463</td>
<td style="text-align: right;">8.474082e+09</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_service_LF</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">1.436783e+11</td>
<td style="text-align: right;">1.353392e+11</td>
<td style="text-align: right;">1.174547e+11</td>
<td style="text-align: right;">1.270765e+11</td>
<td style="text-align: right;">1.427098e+11</td>
<td style="text-align: right;">3.677882e+08</td>
<td style="text-align: right;">4.842498e+11</td>
<td style="text-align: right;">4.838820e+11</td>
<td style="text-align: right;">1.0206</td>
<td style="text-align: right;">0.1319</td>
<td style="text-align: right;">1.953453e+10</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="correlation-analysis-with-target-variable" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis-with-target-variable"><strong>3. Correlation analysis with target variable</strong></h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store a numeric only dataframe for our linear regression</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>numeric_df <span class="ot">=</span> <span class="fu">select</span>(final_data, <span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_all</span>(<span class="fu">all_vars</span>(<span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_all</span>(<span class="fu">all_vars</span>(<span class="fu">is.finite</span>(.)))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># form a correlation matrix</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">=</span> numeric_df <span class="sc">%&gt;%</span> <span class="fu">cor</span>() </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># identify the variable with high correlation </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">method =</span> <span class="st">"color"</span>,  </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">order =</span> <span class="st">"hclust"</span>,  </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">addCoef.col =</span> <span class="st">"black"</span>,  </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.col =</span> <span class="st">"black"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">tl.cex =</span> <span class="fl">0.5</span>,  </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">number.cex =</span> <span class="fl">0.4</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># identify the correlated variables, setting a threshold of 0.3 correlation. (Moderate to strong correlation)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>correlated_variables <span class="ot">=</span> <span class="fu">as.data.frame</span>(cor_matrix) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Pov_headcount) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Pov_headcount <span class="sc">!=</span> <span class="dv">1</span>) </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># these variables with the most correlation </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(correlated_variables <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Pov_headcount)),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"*Variables with moderate to strong Correlation with Poverty Headcount*"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">label=</span> <span class="st">"*Variable*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Variables with moderate to strong Correlation with Poverty Headcount</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;">rowname</th>
<th style="text-align: right;">Pov_headcount</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">GDP_Agriculture_percent</td>
<td style="text-align: right;">0.4343261</td>
</tr>
<tr class="even">
<td style="text-align: left;">Employment_agriculture</td>
<td style="text-align: right;">0.4289738</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unemployment_Rate</td>
<td style="text-align: right;">0.3992461</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_agriculture_LF</td>
<td style="text-align: right;">0.3454094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP</td>
<td style="text-align: right;">0.2689163</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inflation</td>
<td style="text-align: right;">0.2288722</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_industrial_LF</td>
<td style="text-align: right;">0.2241256</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_service_LF</td>
<td style="text-align: right;">0.1812379</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Industry_percent</td>
<td style="text-align: right;">-0.0104379</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_Manufacture_percent</td>
<td style="text-align: right;">-0.0263870</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gini</td>
<td style="text-align: right;">-0.0645768</td>
</tr>
<tr class="even">
<td style="text-align: left;">Employment_industry</td>
<td style="text-align: right;">-0.2456589</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Employment_service</td>
<td style="text-align: right;">-0.3779099</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_Service_percent</td>
<td style="text-align: right;">-0.4120079</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDPperCapita</td>
<td style="text-align: right;">-0.5944919</td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
<td style="text-align: right;">-0.6058433</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt the data frame</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df_melt0 <span class="ot">&lt;-</span> <span class="fu">melt</span>(numeric_df <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="fu">colnames</span>(<span class="fu">t</span>(correlated_variables)),<span class="st">"Pov_headcount"</span>)), <span class="at">id.vars =</span> <span class="st">"Pov_headcount"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplots</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>scatterplots0 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_melt0, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> Pov_headcount)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot Matrix Against Pov_headcount"</span>)<span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">linewidth =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"red"</span>,<span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scatterplots0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-normalization-of-selected-input" class="level2">
<h2 class="anchored" data-anchor-id="data-normalization-of-selected-input"><strong>4. Data Normalization of selected input</strong></h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a recipe for data preprocessing with imputation</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>rec1 <span class="ot">&lt;-</span> <span class="fu">recipe</span>(<span class="sc">~</span> ., <span class="at">data =</span> final_data) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">step_YeoJohnson</span>(<span class="fu">colnames</span>(<span class="fu">t</span>(correlated_variables))) <span class="co"># Normalize numeric predictors</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the recipe</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>rec_prep1 <span class="ot">&lt;-</span> <span class="fu">prep</span>(rec1, <span class="at">training =</span> final_data)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the recipe to the data (bake the recipe)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>normalized_final_data <span class="ot">&lt;-</span> <span class="fu">bake</span>(rec_prep1, <span class="at">new_data =</span>final_data )</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>df_melt1 <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">select</span>(normalized_final_data, <span class="fu">where</span>(is.numeric))<span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="fu">colnames</span>(<span class="fu">t</span>(correlated_variables)),<span class="st">"Pov_headcount"</span>)), <span class="at">id.vars =</span> <span class="st">"Pov_headcount"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>distributions1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_melt1, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distributions Against Poverty Headcount"</span>)<span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>distributions1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>scatterplots1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_melt1, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> Pov_headcount)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot Matrix Against Poverty Headcount"</span>)<span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"red"</span>,<span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(scatterplots1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-partitioning" class="level2">
<h2 class="anchored" data-anchor-id="data-partitioning"><strong>5. Data partitioning</strong></h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># our selected data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>selected_inputs <span class="ot">=</span> <span class="fu">select</span>(final_data, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">c</span>(<span class="st">"Pov_headcount"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">colnames</span>(<span class="fu">as.data.frame</span>(<span class="fu">t</span>(correlated_variables)))))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># split data to training and testing</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>df_split <span class="ot">=</span> <span class="fu">initial_split</span>(selected_inputs, <span class="at">prop =</span> <span class="fl">0.7</span>, <span class="at">strata =</span> Pov_headcount)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># input train and test data </span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>df_train <span class="ot">=</span> <span class="fu">training</span>(df_split) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>df_test <span class="ot">=</span> <span class="fu">testing</span>(df_split) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="multiple-linear-regression---ordinary-least-squared" class="level1">
<h1><strong>Multiple Linear Regression - Ordinary Least Squared</strong></h1>
<section id="training-multiple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="training-multiple-linear-regression"><strong>1. Training Multiple Linear Regression</strong></h2>
<section id="train-and-evaluate-initial-regression-mode" class="level3">
<h3 class="anchored" data-anchor-id="train-and-evaluate-initial-regression-mode"><strong>1.1. Train and evaluate initial regression mode</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># form the formula</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>first_fmla <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="st">"Pov_headcount ~ year +</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">                        GDP + GDPperCapita + Gini + Inflation +</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">                        GDP_Agriculture_percent + GDP_Manufacture_percent +</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">                        GDP_Industry_percent + GDP_Service_percent + </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">                        Unemployment_Rate + Employment_agriculture  + </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">                        Employment_industry + Employment_service +</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">                        GDP_agriculture_LF + GDP_industrial_LF + GDP_service_LF"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># formula being used</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>linear_model0 <span class="ot">=</span> <span class="fu">lm</span>(first_fmla,<span class="at">data =</span> df_train) </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># recieve results</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>df_results0 <span class="ot">=</span> <span class="fu">cbind</span>(df_train,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(linear_model0,<span class="at">interval =</span> <span class="st">"prediction"</span>)))</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># model summary</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>linear0_summary <span class="ot">=</span> <span class="fu">summary</span>(linear_model0)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>modelsummary_output <span class="ot">&lt;-</span> <span class="fu">modelsummary</span>(</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(linear_model0), </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"gt"</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"t = {statistic}"</span>, <span class="st">"se = {std.error}"</span>, <span class="st">'p.value'</span>),</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the gt  to kableExtra</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(modelsummary_output <span class="sc">%&gt;%</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(),</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"*Initial training model summary*"</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Initial training model summary</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">-1389.685</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -0.906</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 1533.575</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.376)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">year</td>
<td style="text-align: left;">-0.005+</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -2.024</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.057)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 1.388</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.181)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDPperCapita</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -1.206</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.243)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gini</td>
<td style="text-align: left;">-0.805*</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -2.470</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.326</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.023)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inflation</td>
<td style="text-align: left;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 0.733</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.005</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.473)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Agriculture_percent</td>
<td style="text-align: left;">-0.009</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -1.312</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.007</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.205)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Manufacture_percent</td>
<td style="text-align: left;">0.010**</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 2.906</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.009)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Industry_percent</td>
<td style="text-align: left;">-0.012+</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -1.753</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.007</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.096)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Service_percent</td>
<td style="text-align: left;">-0.016*</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -2.511</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.007</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.021)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unemployment_Rate</td>
<td style="text-align: left;">-0.002</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -0.110</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.014</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.913)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Employment_agriculture</td>
<td style="text-align: left;">14.012</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 0.914</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 15.322</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.372)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Employment_industry</td>
<td style="text-align: left;">14.005</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 0.914</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 15.320</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.372)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Employment_service</td>
<td style="text-align: left;">14.018</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 0.915</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 15.322</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.372)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_agriculture_LF</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -0.773</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.449)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_industrial_LF</td>
<td style="text-align: left;">0.000+</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -1.991</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.061)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_service_LF</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -0.908</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.375)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Num.Obs.</td>
<td style="text-align: left;">36</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: left;">0.920</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R2 Adj.</td>
<td style="text-align: left;">0.852</td>
</tr>
<tr class="even">
<td style="text-align: left;">AIC</td>
<td style="text-align: left;">-132.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BIC</td>
<td style="text-align: left;">-104.4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Log.Lik.</td>
<td style="text-align: left;">84.445</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: left;">0.02</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="checking-for-multicollinearity-variance-of-influence-vif" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-multicollinearity-variance-of-influence-vif"><strong>1.2. Checking for Multicollinearity: Variance of Influence (VIF)</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># form a VIF plot </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>VIF_linear_0 <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">vif</span>(linear_model0)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> rowname, <span class="at">y =</span> <span class="fu">vif</span>(linear_model0)))<span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">5</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">'blue'</span>)<span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"VIF Values of Predictor Variables"</span>, <span class="at">x=</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">'VIF values'</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>VIF_linear_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Since the three variables “Employment_service”, “Employment_industry”, and “Employment_agriculture” have high multicolinearities, they should be removed from the dataset.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># form the formula</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>second_fmla <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="st">"Pov_headcount ~ year +</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="st">                        GDP + GDPperCapita + Gini + Inflation +</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="st">                        GDP_Agriculture_percent + GDP_Manufacture_percent +</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">                        GDP_Industry_percent + GDP_Service_percent + </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">                        Unemployment_Rate + </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="st">                        GDP_agriculture_LF + GDP_industrial_LF + GDP_service_LF"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># formula being used</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>linear_model1 <span class="ot">=</span> <span class="fu">lm</span>(second_fmla,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset being used</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df_train) </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co"># recieve results</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>df_results1 <span class="ot">=</span> <span class="fu">cbind</span>(df_train,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(linear_model1,<span class="at">interval =</span> <span class="st">"prediction"</span>)))</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># recieve residuals</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>df_results1<span class="sc">$</span>residuals <span class="ot">=</span> linear_model1<span class="sc">$</span>residuals</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># model summary</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>linear1_summary <span class="ot">=</span> <span class="fu">summary</span>(linear_model1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="training-model-evaluation-after-adjusting-for-multicolinearity" class="level3">
<h3 class="anchored" data-anchor-id="training-model-evaluation-after-adjusting-for-multicolinearity"><strong>1.3. Training model evaluation after adjusting for multicolinearity</strong></h3>
</section>
<section id="model-summary" class="level3">
<h3 class="anchored" data-anchor-id="model-summary">Model Summary</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate RMSE</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>rmse_lm_train <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(df_results1<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MAE</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>mae_lm_train <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(df_results1<span class="sc">$</span>residuals))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSE</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>mse_lm_train <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_results1<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate AIC</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>aic_value_lm_train <span class="ot">&lt;-</span> <span class="fu">AIC</span>(linear_model1)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate BIC</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>bic_value_lm_train <span class="ot">&lt;-</span> <span class="fu">BIC</span>(linear_model1)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>modelsummary_output1 <span class="ot">&lt;-</span> <span class="fu">modelsummary</span>(</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(linear_model1), </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"gt"</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"t = {statistic}"</span>, <span class="st">"se = {std.error}"</span>, <span class="st">'p.value'</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">as.data.frame</span>(modelsummary_output1),</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"*Training model summary*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Training model summary</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: left;">22.151***</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 4.316</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 5.132</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(&lt;0.001)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">year</td>
<td style="text-align: left;">-0.011***</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -4.145</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(&lt;0.001)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -0.377</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.710)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDPperCapita</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -0.653</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.520)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gini</td>
<td style="text-align: left;">-0.876*</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -2.104</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.416</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.047)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inflation</td>
<td style="text-align: left;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 0.235</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.006</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.817)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Agriculture_percent</td>
<td style="text-align: left;">-0.009</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -1.470</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.006</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.156)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Manufacture_percent</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -0.034</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.973)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Industry_percent</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -0.014</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.005</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.989)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Service_percent</td>
<td style="text-align: left;">-0.007</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -1.293</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.005</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.210)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unemployment_Rate</td>
<td style="text-align: left;">0.010</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 0.814</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.012</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.424)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_agriculture_LF</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 0.679</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.504)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_industrial_LF</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = -0.779</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.444)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_service_LF</td>
<td style="text-align: left;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">t = 1.558</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">se = 0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(0.133)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Num.Obs.</td>
<td style="text-align: left;">36</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: left;">0.834</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R2 Adj.</td>
<td style="text-align: left;">0.737</td>
</tr>
<tr class="even">
<td style="text-align: left;">AIC</td>
<td style="text-align: left;">-112.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BIC</td>
<td style="text-align: left;">-89.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Log.Lik.</td>
<td style="text-align: left;">71.384</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RMSE</td>
<td style="text-align: left;">0.03</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="model-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="model-evaluation">Model Evaluation</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># collect train metrics</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>lm_train_metrics <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"rmse"</span>, <span class="st">"rsq"</span>, <span class="st">"mae"</span>, <span class="st">"mse"</span>, <span class="st">"aic"</span>,<span class="st">"bic"</span>),</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm_train =</span> <span class="fu">c</span>(rmse_lm_train, linear1_summary<span class="sc">$</span>r.squared, mae_lm_train, mse_lm_train, aic_value_lm_train, bic_value_lm_train ))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(lm_train_metrics,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"*Training model performance metrics*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Training model performance metrics</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: right;">lm_train</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rmse</td>
<td style="text-align: right;">0.0333120</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsq</td>
<td style="text-align: right;">0.8344454</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mae</td>
<td style="text-align: right;">0.0246942</td>
</tr>
<tr class="even">
<td style="text-align: left;">mse</td>
<td style="text-align: right;">0.0011097</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aic</td>
<td style="text-align: right;">-112.7686444</td>
</tr>
<tr class="even">
<td style="text-align: left;">bic</td>
<td style="text-align: right;">-89.0158603</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We’ve eventually arrive to this initial final model after adjusting for multicollinearity.</p>
</section>
<section id="prediction-vs-actual-plot" class="level3">
<h3 class="anchored" data-anchor-id="prediction-vs-actual-plot"><strong>1.4. Prediction vs actual plot</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the prediction</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>r_squared_linear1 <span class="ot">=</span> <span class="fu">ggplot</span>(df_results1, <span class="fu">aes</span>(<span class="at">x =</span> fit, Pov_headcount)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_obs_pred</span>()<span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Predicted vs Actual Poverty Headcount"</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="st">"Training Model using Linear Regression"</span>) <span class="sc">+</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Predicted Poverty Headcount"</span>)<span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Actual Poverty Headcount"</span>) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">0.3</span>, <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"R-squared:"</span>, <span class="fu">round</span>(linear1_summary<span class="sc">$</span>r.squared,<span class="dv">2</span>)))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>r_squared_linear1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="residuals-diagnostics"><strong>1.5. Residuals diagnostics</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># form a residual histogram plot</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>residual_linear1 <span class="ot">=</span> <span class="fu">ggplot</span>(df_results1, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Residuals"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(df_results1<span class="sc">$</span>residuals), </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(df_results1<span class="sc">$</span>residuals), </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.17</span>, </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Mean: "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(df_results1<span class="sc">$</span>residuals),<span class="dv">2</span>)), </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span> ) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,<span class="at">x =</span> <span class="fl">2.3</span>, <span class="at">y =</span> <span class="fl">0.20</span>, </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Median: "</span>, <span class="fu">round</span>(<span class="fu">median</span>(df_results1<span class="sc">$</span>residuals),<span class="dv">2</span>)), </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"darkgreen"</span> ) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># lm model, uses ordinary least squares regession to fit a straight line</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>residual_fit1 <span class="ot">=</span> <span class="fu">ggplot</span>(df_results1, <span class="fu">aes</span>(<span class="at">x =</span> fit, <span class="at">y =</span> residuals))<span class="sc">+</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span><span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Residual plot "</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co"># qq plot</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>qq_plot1 <span class="ot">=</span> <span class="fu">ggplot</span>(df_results1, <span class="fu">aes</span>(<span class="at">sample =</span> residuals)) <span class="sc">+</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Q-Q Plot "</span>, <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>, <span class="at">y =</span> <span class="st">"Sample Quantiles"</span>)<span class="sc">+</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a> residual_linear1 <span class="sc">+</span> (  qq_plot1<span class="sc">/</span> residual_fit1 ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histogram-of-residuals" class="level3">
<h3 class="anchored" data-anchor-id="histogram-of-residuals">1. <strong>Histogram of Residuals</strong></h3>
<ul>
<li><p><strong>Distribution and Normality</strong>: The residuals appear to be <strong>centered around zero</strong>, suggesting that the model is unbiased. While most residuals are concentrated near the center, there are <strong>some long tails on the left</strong> side, indicating the possibility of <strong>outliers</strong> or slight deviation from normality.</p></li>
<li><p><strong>Symmetry</strong>: Although the distribution is close to symmetric, the longer left tail hints at <strong>potential skewness</strong> that may require further investigation, especially if these outliers affect model performance.</p></li>
</ul>
</section>
<section id="q-q-plot" class="level3">
<h3 class="anchored" data-anchor-id="q-q-plot">2. <strong>Q-Q Plot</strong></h3>
<ul>
<li><p><strong>Normality Check</strong>: Most of the points align along the <strong>45-degree line</strong>, suggesting that the residuals generally follow a <strong>normal distribution</strong>. However, some deviations occur at the <strong>extremes</strong>, indicating the possibility of <strong>outliers</strong> or slight non-normal behavior in the tails.</p></li>
<li><p><strong>Impact of Outliers</strong>: These deviations, especially at the lower and upper quantiles, could affect <strong>model reliability</strong> if not addressed, though they appear minor in this plot.</p></li>
</ul>
</section>
<section id="residual-plot-residuals-vs.-fitted-values" class="level3">
<h3 class="anchored" data-anchor-id="residual-plot-residuals-vs.-fitted-values">3. <strong>Residual Plot (Residuals vs.&nbsp;Fitted Values)</strong></h3>
<ul>
<li><p><strong>Random Distribution</strong>: The residuals are scattered randomly, without any clear trend or pattern, which indicates that the <strong>model fits the data well</strong> and there are no obvious <strong>misspecifications</strong> in the relationship between predictors and the response variable.</p></li>
<li><p><strong>Homoscedasticity</strong>: The residuals seem to have a <strong>relatively consistent spread</strong> across the range of fitted values, suggesting <strong>no signs of heteroscedasticity</strong> (variance of residuals remains fairly constant).</p></li>
<li><p><strong>Minor Curvature</strong>: There is a <strong>slight curvature</strong> visible in the low-to-mid range of fitted values. This could indicate that some <strong>non-linearity</strong> might exist, but it seems small enough that the overall model still captures the primary relationship adequately.</p></li>
</ul>
</section>
</section>
<section id="k-fold-cross-validation" class="level2">
<h2 class="anchored" data-anchor-id="k-fold-cross-validation"><strong>2. K-fold Cross-validation</strong></h2>
<section id="cross-validation-performance-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-performance-evaluation"><strong>2.1. Cross-validation performance evaluation</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify a model</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>lm_model0 <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a recipe for data preprocessing</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(second_fmla, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> df_train) </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a workflow</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rec) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_model0)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 10-fold cross-validation resamples</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(df_train, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> wf <span class="sc">%&gt;%</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> folds,</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq),</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_resamples</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect and summarize metrics</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>metrics_cv <span class="ot">=</span> results <span class="sc">%&gt;%</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>()</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize results </span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>lm_cv_predictions <span class="ot">=</span> results <span class="sc">%&gt;%</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_predictions</span>()</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to fit model and extract AIC/BIC</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>extract_aic_bic <span class="ot">&lt;-</span> <span class="cf">function</span>(split) {</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> <span class="fu">analysis</span>(split)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  mod_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Pov_headcount <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(mod_fit)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> <span class="fu">BIC</span>(mod_fit)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> split<span class="sc">$</span>id,</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIC =</span> aic,</span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">BIC =</span> bic</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>aic_bic_results <span class="ot">&lt;-</span> folds <span class="sc">%&gt;%</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">results =</span> <span class="fu">map</span>(splits, extract_aic_bic)) <span class="sc">%&gt;%</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, results) <span class="sc">%&gt;%</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> results, <span class="at">names_repair =</span> <span class="st">"unique"</span>)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the results</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>aic_bic_summary <span class="ot">&lt;-</span> aic_bic_results <span class="sc">%&gt;%</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_AIC =</span> <span class="fu">mean</span>(AIC),</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_BIC =</span> <span class="fu">mean</span>(BIC)</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="co"># collect cv metrics</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>lm_cv_metrics <span class="ot">=</span> metrics_cv <span class="sc">%&gt;%</span> </span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">metric =</span> .metric, <span class="at">lm_crossvalidate =</span> mean,) </span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate residuals </span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>lm_cv_residuals <span class="ot">=</span> lm_cv_predictions<span class="sc">$</span>.pred <span class="sc">-</span> lm_cv_predictions<span class="sc">$</span>Pov_headcount</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate MAE</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>mae_cv <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(lm_cv_residuals))</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate MSE</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>mse_cv <span class="ot">&lt;-</span> <span class="fu">mean</span>((lm_cv_residuals)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>lm_cv_metrics <span class="ot">=</span> lm_cv_metrics <span class="sc">%&gt;%</span> </span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">data.frame</span>(<span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"mae"</span>, <span class="st">"mse"</span>, <span class="st">"aic"</span>, <span class="st">"bic"</span>),</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>           <span class="at">lm_crossvalidate =</span> <span class="fu">c</span>(mae_cv, mse_cv,</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a>                                aic_bic_summary<span class="sc">$</span>mean_AIC, </span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>                                aic_bic_summary<span class="sc">$</span>mean_BIC)), </span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"lm_crossvalidate"</span>, <span class="st">"metric"</span>))</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="co"># combine all metrics in linear model</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>train_metrics_lm <span class="ot">=</span> <span class="fu">full_join</span>(lm_train_metrics, lm_cv_metrics,</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"metric"</span>)</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(train_metrics_lm,</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"*Train and Cross-validation performance metrics*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Train and Cross-validation performance metrics</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: right;">lm_train</th>
<th style="text-align: right;">lm_crossvalidate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rmse</td>
<td style="text-align: right;">0.0333120</td>
<td style="text-align: right;">0.0922748</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsq</td>
<td style="text-align: right;">0.8344454</td>
<td style="text-align: right;">0.3970362</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mae</td>
<td style="text-align: right;">0.0246942</td>
<td style="text-align: right;">0.0643382</td>
</tr>
<tr class="even">
<td style="text-align: left;">mse</td>
<td style="text-align: right;">0.0011097</td>
<td style="text-align: right;">0.0145805</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aic</td>
<td style="text-align: right;">-112.7686444</td>
<td style="text-align: right;">-122.5038953</td>
</tr>
<tr class="even">
<td style="text-align: left;">bic</td>
<td style="text-align: right;">-89.0158603</td>
<td style="text-align: right;">-95.8990931</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="prediction-vs-actual-plot-1" class="level3">
<h3 class="anchored" data-anchor-id="prediction-vs-actual-plot-1"><strong>2.2. Prediction vs Actual Plot</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>lm_cv_predictions<span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> Pov_headcount)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Predicted vs Actual Poverty Headcount"</span>, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="st">"K-Fold Cross-validation resamples for Linear Regression"</span>) <span class="sc">+</span>   <span class="fu">coord_obs_pred</span>()<span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Predicted Poverty Headcount"</span>)<span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Actual Poverty Headcount"</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span><span class="fl">0.6</span>, <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"R-squared:"</span>, <span class="fu">round</span>(metrics_cv<span class="sc">$</span>mean[<span class="dv">2</span>],<span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We’ve reached our optimum OLS linear model, the R-squared seems to reach 0.4 even with cross-validation testing.</p>
</section>
<section id="residual-diagnostic" class="level3">
<h3 class="anchored" data-anchor-id="residual-diagnostic"><strong>2.3. Residual Diagnostic</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_cv_resid <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">"residuals"</span> <span class="ot">=</span> lm_cv_residuals,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fit =</span> df_train<span class="sc">$</span>Pov_headcount)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># form a residual histogram plot</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>residual_linear_cv <span class="ot">=</span> <span class="fu">ggplot</span>(df_cv_resid, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Residuals"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(df_cv_resid<span class="sc">$</span>residuals), </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(df_cv_resid<span class="sc">$</span>residuals), </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.17</span>, </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Mean: "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(df_cv_resid<span class="sc">$</span>residuals),<span class="dv">2</span>)), </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span> ) <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,<span class="at">x =</span> <span class="fl">2.3</span>, <span class="at">y =</span> <span class="fl">0.20</span>, </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Median: "</span>, <span class="fu">round</span>(<span class="fu">median</span>(df_cv_resid<span class="sc">$</span>residuals),<span class="dv">2</span>)), </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"darkgreen"</span> ) <span class="sc">+</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co"># lm model, uses ordinary least squares regession to fit a straight line</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>residual_fit_cv <span class="ot">=</span> <span class="fu">ggplot</span>(df_cv_resid, <span class="fu">aes</span>(<span class="at">x =</span> fit, <span class="at">y =</span> residuals))<span class="sc">+</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span><span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Residual plot "</span>)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="co"># qq plot</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>qq_plot_cv <span class="ot">=</span> <span class="fu">ggplot</span>(df_cv_resid, <span class="fu">aes</span>(<span class="at">sample =</span> residuals)) <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Q-Q Plot "</span>, <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>, <span class="at">y =</span> <span class="st">"Sample Quantiles"</span>)<span class="sc">+</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a> residual_linear_cv <span class="sc">+</span> (  qq_plot_cv<span class="sc">/</span> residual_fit_cv ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histogram-of-residuals-1" class="level3">
<h3 class="anchored" data-anchor-id="histogram-of-residuals-1">1. <strong>Histogram of Residuals</strong></h3>
<ul>
<li><p><strong>Distribution and Symmetry</strong>: The residuals are <strong>symmetrically distributed around zero</strong>, indicating no noticeable bias in the model. However, the frequency is very high near the center, with a few <strong>outliers</strong> at both ends.</p></li>
<li><p><strong>Potential Outliers</strong>: Some residuals fall far from zero, suggesting <strong>potential outliers</strong>, though they appear to be rare and likely don’t have a major impact on the model’s overall performance.</p></li>
</ul>
</section>
<section id="q-q-plot-1" class="level3">
<h3 class="anchored" data-anchor-id="q-q-plot-1">2. <strong>Q-Q Plot</strong></h3>
<ul>
<li><p><strong>Normality Check</strong>: Most of the points lie <strong>along the 45-degree line</strong>, confirming that the residuals approximately follow a <strong>normal distribution</strong>. However, there are slight deviations at <strong>extreme values</strong>, both at the lower and upper ends.</p></li>
<li><p><strong>Impact of Outliers</strong>: These deviations suggest that a few data points may not fit the normality assumption perfectly, and further investigation is recommended to see if these points affect the model’s accuracy.</p></li>
</ul>
</section>
<section id="residual-plot-residuals-vs.-fitted-values-1" class="level3">
<h3 class="anchored" data-anchor-id="residual-plot-residuals-vs.-fitted-values-1">3. <strong>Residual Plot (Residuals vs.&nbsp;Fitted Values)</strong></h3>
<ul>
<li><p><strong>Random Distribution</strong>: The residuals are <strong>scattered randomly</strong> without any distinct pattern, indicating that the model captures the main relationship between the predictors and the response variable.</p></li>
<li><p><strong>Homoscedasticity (Constant Variance)</strong>: The residuals display a fairly <strong>consistent spread</strong> across fitted values, meaning there are no signs of <strong>heteroscedasticity</strong> (non-constant variance).</p></li>
<li><p><strong>Slight Non-linearity</strong>: There is <strong>minor curvature</strong> visible, suggesting some small degree of <strong>non-linearity</strong>, but it seems minimal and unlikely to affect the model’s overall fit.</p></li>
</ul>
</section>
</section>
<section id="prediction-and-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="prediction-and-evaluation"><strong>3. Prediction and Evaluation</strong></h2>
<section id="testing-performance-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="testing-performance-evaluation"><strong>3.1. Testing performance evaluation</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on the test dataset</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>model_fit0 <span class="ot">&lt;-</span> wf <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> df_train)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>test_predictions0 <span class="ot">&lt;-</span> model_fit0 <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> df_test) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df_test)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># get residuals </span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>test_predictions0 <span class="ot">&lt;-</span> test_predictions0 <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residuals =</span> Pov_headcount <span class="sc">-</span> .pred)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>metrics0 <span class="ot">&lt;-</span> test_predictions0 <span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">metrics</span>(<span class="at">truth =</span> Pov_headcount, <span class="at">estimate =</span> .pred)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># collect testing metrics</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co"># get mse</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>mse_testing <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">metric =</span> <span class="st">"mse"</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">lm_testing =</span> <span class="fu">mean</span>((test_predictions0<span class="sc">$</span>residuals)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># make test metrics </span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>lm_test_metrics <span class="ot">=</span> metrics0 <span class="sc">%&gt;%</span> </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">metric =</span> .metric, </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">lm_testing =</span> .estimate) <span class="sc">%&gt;%</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(mse_testing)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># combine all metrics in linear model</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>joined_metrics_lm <span class="ot">=</span> <span class="fu">full_join</span>(lm_train_metrics, lm_cv_metrics,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"metric"</span>) <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(lm_test_metrics)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics of the test dataset</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(model_fit0 <span class="sc">%&gt;%</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"*Testing model summary*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Testing model summary</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">22.1505325</td>
<td style="text-align: right;">5.1316394</td>
<td style="text-align: right;">4.3164632</td>
<td style="text-align: right;">0.0002785</td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
<td style="text-align: right;">-0.0105889</td>
<td style="text-align: right;">0.0025546</td>
<td style="text-align: right;">-4.1451028</td>
<td style="text-align: right;">0.0004233</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.3766016</td>
<td style="text-align: right;">0.7100775</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDPperCapita</td>
<td style="text-align: right;">-0.0000078</td>
<td style="text-align: right;">0.0000119</td>
<td style="text-align: right;">-0.6531840</td>
<td style="text-align: right;">0.5204062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Gini</td>
<td style="text-align: right;">-0.8759785</td>
<td style="text-align: right;">0.4163397</td>
<td style="text-align: right;">-2.1039997</td>
<td style="text-align: right;">0.0470331</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inflation</td>
<td style="text-align: right;">0.0013697</td>
<td style="text-align: right;">0.0058369</td>
<td style="text-align: right;">0.2346616</td>
<td style="text-align: right;">0.8166416</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Agriculture_percent</td>
<td style="text-align: right;">-0.0089425</td>
<td style="text-align: right;">0.0060853</td>
<td style="text-align: right;">-1.4695359</td>
<td style="text-align: right;">0.1558439</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_Manufacture_percent</td>
<td style="text-align: right;">-0.0001105</td>
<td style="text-align: right;">0.0032734</td>
<td style="text-align: right;">-0.0337666</td>
<td style="text-align: right;">0.9733677</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_Industry_percent</td>
<td style="text-align: right;">-0.0000674</td>
<td style="text-align: right;">0.0049590</td>
<td style="text-align: right;">-0.0135819</td>
<td style="text-align: right;">0.9892860</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_Service_percent</td>
<td style="text-align: right;">-0.0068579</td>
<td style="text-align: right;">0.0053051</td>
<td style="text-align: right;">-1.2926971</td>
<td style="text-align: right;">0.2095280</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unemployment_Rate</td>
<td style="text-align: right;">0.0095638</td>
<td style="text-align: right;">0.0117497</td>
<td style="text-align: right;">0.8139562</td>
<td style="text-align: right;">0.4243929</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_agriculture_LF</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.6793653</td>
<td style="text-align: right;">0.5039922</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDP_industrial_LF</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-0.7787865</td>
<td style="text-align: right;">0.4444021</td>
</tr>
<tr class="even">
<td style="text-align: left;">GDP_service_LF</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.5582924</td>
<td style="text-align: right;">0.1334342</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The testing model summary explores the relationships between key predictors and the dependent variable. <strong>Year</strong> (estimate = -0.0106, p &lt; 0.001) shows a <strong>negative and significant impact</strong>, suggesting that the dependent variable has been decreasing slightly over time. <strong>Gini coefficient</strong> (estimate = -0.876, p ≈ 0.047) is also significant, indicating that <strong>greater income inequality</strong> is associated with lower outcomes for the dependent variable.</p>
<p>Meanwhile, <strong>GDP per capita</strong> (estimate = -0.000008, p &gt; 0.5) and <strong>Inflation</strong> (estimate = 0.0014, p &gt; 0.8) are not significant predictors, implying that economic indicators and price stability do not have a meaningful effect. Similarly, sectoral GDP contributions — such as <strong>agriculture, manufacturing, industry, and services</strong> — show no significant influence (all p-values &gt; 0.1), suggesting these factors alone do not strongly affect the target outcome.</p>
<p>The <strong>unemployment rate</strong> (estimate = 0.0096, p &gt; 0.4) shows a weak positive relationship but remains statistically insignificant. Labor force participation in <strong>agriculture, industry, and services</strong> also has no significant impact (all p-values &gt; 0.1).</p>
<p>These results suggest that <strong>income inequality (Gini)</strong> and <strong>time trends (year)</strong> are the most influential predictors, while other economic indicators, such as GDP contributions and unemployment, show limited relevance in explaining the variation in the target outcome. This aligns with the notion that <strong>inequality</strong> and <strong>time-driven shifts</strong> play key roles, while broader macroeconomic variables may have more indirect or nuanced effects.</p>
</section>
<section id="overall-ols-regressions-performance-metrics" class="level3">
<h3 class="anchored" data-anchor-id="overall-ols-regressions-performance-metrics"><strong>3.2. Overall OLS regression’s performance metrics</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(joined_metrics_lm,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"*Multiple Linear Regression's perfomance metrics*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Multiple Linear Regression’s perfomance metrics</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: right;">lm_train</th>
<th style="text-align: right;">lm_crossvalidate</th>
<th style="text-align: right;">lm_testing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rmse</td>
<td style="text-align: right;">0.0333120</td>
<td style="text-align: right;">0.0922748</td>
<td style="text-align: right;">0.0610786</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsq</td>
<td style="text-align: right;">0.8344454</td>
<td style="text-align: right;">0.3970362</td>
<td style="text-align: right;">0.7363230</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mae</td>
<td style="text-align: right;">0.0246942</td>
<td style="text-align: right;">0.0643382</td>
<td style="text-align: right;">0.0461560</td>
</tr>
<tr class="even">
<td style="text-align: left;">mse</td>
<td style="text-align: right;">0.0011097</td>
<td style="text-align: right;">0.0145805</td>
<td style="text-align: right;">0.0037306</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="prediction-vs-actual-plot-2" class="level3">
<h3 class="anchored" data-anchor-id="prediction-vs-actual-plot-2"><strong>3.3. Prediction vs actual plot</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>test_predictions0 <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> Pov_headcount)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Predicted vs Actual Poverty Headcount"</span>, </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="st">"Linear Regression Testing set"</span>) <span class="sc">+</span>   <span class="fu">coord_obs_pred</span>()<span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Predicted Poverty Headcount"</span>)<span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Actual Poverty Headcount"</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="dv">1</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"R-squared:"</span>, </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">round</span>(metrics0<span class="sc">$</span>.estimate[<span class="dv">2</span>],<span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residual-diagnostic-of-testing-data" class="level3">
<h3 class="anchored" data-anchor-id="residual-diagnostic-of-testing-data"><strong>3.4. Residual Diagnostic of testing data</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># form a residual histogram plot</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>histogram_linear_test <span class="ot">=</span> <span class="fu">ggplot</span>(test_predictions0, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Residuals"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(test_predictions0<span class="sc">$</span>residuals), </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(test_predictions0<span class="sc">$</span>residuals), </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>)<span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.17</span>, </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Mean: "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(test_predictions0<span class="sc">$</span>residuals),<span class="dv">2</span>)), </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span> )<span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,<span class="at">x =</span> <span class="fl">2.3</span>, <span class="at">y =</span> <span class="fl">0.20</span>, </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Median: "</span>, <span class="fu">round</span>(<span class="fu">median</span>(test_predictions0<span class="sc">$</span>residuals),<span class="dv">2</span>)), </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"darkgreen"</span> )<span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="co"># lm model, uses ordinary least squares regession to fit a straight line</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>residual_fit_test_linear <span class="ot">=</span> <span class="fu">ggplot</span>(test_predictions0, <span class="fu">aes</span>(<span class="at">x =</span> Pov_headcount, <span class="at">y =</span> residuals))<span class="sc">+</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span><span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"fit vs residuals"</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>qq_linear_test <span class="ot">=</span> <span class="fu">ggplot</span>(test_predictions0, <span class="fu">aes</span>(<span class="at">sample =</span> residuals)) <span class="sc">+</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Q-Q Plot"</span>, <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>, <span class="at">y =</span> <span class="st">"Sample Quantiles"</span>)<span class="sc">+</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>histogram_linear_test <span class="sc">+</span> (qq_linear_test<span class="sc">/</span>residual_fit_test_linear)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="regularized-regression-l2-and-elastic-net" class="level1">
<h1><strong>Regularized Regression : L2 and Elastic Net</strong></h1>
<p>Since there is severe multicollinearity in the original selected input, we had to delete 3 variables from the selected input even though we still believe those inputs are still useful. Hence, we could’ve capture important information that can better predict Pov_headcount. Therefore, we decided to use Ridge Regression because we wanted to keep all selected variables. We will assign them different weightage and penalty.</p>
<p>We wanted to find the optimal values of lambda. We do this by using 10 fold cross validation</p>
<section id="further-preprocessing-standardization" class="level2">
<h2 class="anchored" data-anchor-id="further-preprocessing-standardization"><strong>1. Further preprocessing: Standardization</strong></h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize the train variable</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>blueprint <span class="ot">=</span> <span class="fu">recipe</span>(Pov_headcount <span class="sc">~</span> ., <span class="at">data =</span> df_train)<span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>())</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>prepare <span class="ot">&lt;-</span> <span class="fu">prep</span>(blueprint, <span class="at">training =</span> df_train)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>ridge_train <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> df_train)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># standardize the test variable</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>blueprint_test <span class="ot">=</span> <span class="fu">recipe</span>(Pov_headcount <span class="sc">~</span> ., <span class="at">data =</span> df_test)<span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>())</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>prepare_test  <span class="ot">&lt;-</span> <span class="fu">prep</span>(blueprint, <span class="at">training =</span> df_test)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>ridge_test <span class="ot">&lt;-</span> <span class="fu">bake</span>(prepare, <span class="at">new_data =</span> df_test)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>X_test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Pov_headcount <span class="sc">~</span> ., ridge_test)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># transform y with log transformation</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>Y_test <span class="ot">&lt;-</span> ridge_test<span class="sc">$</span>Pov_headcount</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Pov_headcount <span class="sc">~</span> ., ridge_train)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co"># transform y with log transformation</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> ridge_train<span class="sc">$</span>Pov_headcount</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>X <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      year              Gini               GDP           GDPperCapita     
 Min.   :-2.9558   Min.   :-2.06168   Min.   :-0.9202   Min.   :-1.41323  
 1st Qu.:-0.2227   1st Qu.:-0.61040   1st Qu.:-0.6038   1st Qu.:-0.79826  
 Median : 0.1417   Median : 0.03014   Median :-0.4463   Median :-0.09848  
 Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.00000  
 3rd Qu.: 0.5061   3rd Qu.: 0.44773   3rd Qu.: 0.2248   3rd Qu.: 0.26630  
 Max.   : 1.0528   Max.   : 2.30780   Max.   : 2.5517   Max.   : 3.07042  
   Inflation        Unemployment_Rate  Employment_agriculture
 Min.   :-1.94720   Min.   :-1.50509   Min.   :-2.7647       
 1st Qu.:-0.82842   1st Qu.:-0.54694   1st Qu.:-0.5806       
 Median : 0.08324   Median :-0.03213   Median :-0.2555       
 Mean   : 0.00000   Mean   : 0.00000   Mean   : 0.0000       
 3rd Qu.: 0.78906   3rd Qu.: 0.65619   3rd Qu.: 0.7244       
 Max.   : 1.92433   Max.   : 2.76362   Max.   : 2.8220       
 Employment_service Employment_industry GDP_Industry_percent
 Min.   :-2.3425    Min.   :-2.0981     Min.   :-2.7999     
 1st Qu.:-0.7475    1st Qu.:-0.6095     1st Qu.:-0.4657     
 Median : 0.1523    Median : 0.1227     Median : 0.1040     
 Mean   : 0.0000    Mean   : 0.0000     Mean   : 0.0000     
 3rd Qu.: 0.4908    3rd Qu.: 0.6401     3rd Qu.: 0.7032     
 Max.   : 2.5162    Max.   : 1.8734     Max.   : 1.3585     
 GDP_Service_percent GDP_Agriculture_percent GDP_Manufacture_percent
 Min.   :-2.53750    Min.   :-1.7257         Min.   :-2.7578        
 1st Qu.:-0.63223    1st Qu.:-0.7755         1st Qu.:-0.5817        
 Median :-0.01836    Median : 0.1001         Median : 0.1384        
 Mean   : 0.00000    Mean   : 0.0000         Mean   : 0.0000        
 3rd Qu.: 0.67279    3rd Qu.: 0.5818         3rd Qu.: 0.4842        
 Max.   : 2.62905    Max.   : 2.6524         Max.   : 1.5242        
 GDP_agriculture_LF GDP_industrial_LF GDP_service_LF   
 Min.   :-0.68500   Min.   :-0.9964   Min.   :-1.1459  
 1st Qu.:-0.55213   1st Qu.:-0.7518   1st Qu.:-0.7624  
 Median :-0.48647   Median :-0.4167   Median :-0.3055  
 Mean   : 0.00000   Mean   : 0.0000   Mean   : 0.0000  
 3rd Qu.:-0.09741   3rd Qu.: 0.4788   3rd Qu.: 0.4335  
 Max.   : 2.79801   Max.   : 2.4023   Max.   : 2.3294  </code></pre>
</div>
</div>
<section id="histogram-of-residuals-2" class="level3">
<h3 class="anchored" data-anchor-id="histogram-of-residuals-2">1. <strong>Histogram of Residuals</strong></h3>
<ul>
<li><p><strong>Distribution and Symmetry</strong>: The residuals are <strong>centered around zero</strong>, indicating that the model’s predictions are unbiased. The majority of residuals are concentrated near 0, with fewer extreme values, suggesting the model’s errors are small and mostly symmetric.</p></li>
<li><p><strong>Potential Skewness and Outliers</strong>: There is a <strong>small peak</strong> on the right side (around 0.15 to 0.25), hinting at <strong>some outliers or slight skewness</strong>. While most residuals fit well, these extreme values may need further investigation to assess if they influence model performance.</p></li>
</ul>
</section>
<section id="q-q-plot-2" class="level3">
<h3 class="anchored" data-anchor-id="q-q-plot-2">2. <strong>Q-Q Plot</strong></h3>
<ul>
<li><strong>Normality Check</strong>: The Q-Q plot shows that most points follow the <strong>45-degree line</strong>, indicating that the residuals generally follow a <strong>normal distribution</strong>. However, at both the <strong>lower and upper ends</strong>, there are <strong>deviations from the theoretical quantiles</strong>. This suggests that some residuals at the extremes do not conform perfectly to normality, possibly due to <strong>outliers</strong>.</li>
</ul>
</section>
<section id="residuals-vs.-fitted-values-plot-fit-vs-residuals" class="level3">
<h3 class="anchored" data-anchor-id="residuals-vs.-fitted-values-plot-fit-vs-residuals">3. <strong>Residuals vs.&nbsp;Fitted Values Plot (fit vs residuals)</strong></h3>
<ul>
<li><p><strong>Random Distribution and Patterns</strong>: The plot shows residuals that are <strong>mostly random</strong> but with a <strong>slight non-linear pattern</strong>. A curve appears in the red trend line, suggesting that the model might not fully capture some non-linear relationships in the data.</p></li>
<li><p><strong>Homoscedasticity (Variance Check)</strong>: The residual spread is relatively consistent for lower fitted values but becomes more variable at higher fitted values (around 0.3). This <strong>increase in variability</strong> might indicate <strong>mild heteroscedasticity</strong>, meaning the residual variance changes slightly across fitted values.</p></li>
</ul>
</section>
</section>
<section id="ridge-regression-training-and-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="ridge-regression-training-and-evaluation"><strong>2. Ridge Regression Training and Evaluation</strong></h2>
<section id="regularization-path-plot" class="level3">
<h3 class="anchored" data-anchor-id="regularization-path-plot"><strong>2.1 Regularization path plot</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> Y,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">0</span>) <span class="co"># a = ridge </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridge, <span class="at">main =</span> <span class="st">"Ridge penalty</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot illustrates how the <strong>coefficients change as the ridge regularization strength increases</strong> (moving right along the x-axis). As the <strong>L1 norm</strong> increases (associated with increasing regularization), <strong>coefficients shrink closer to zero</strong>, demonstrating the effect of ridge regression. Unlike LASSO regression, where some coefficients may become exactly zero, <strong>ridge regression retains all coefficients</strong>, meaning that every predictor variable continues to contribute to the model to some degree, albeit with reduced influence.</p>
<p>The <strong>horizontal spread of the coefficients</strong> shows that the model’s sensitivity to individual predictors is reduced as regularization increases. This helps <strong>prevent overfitting</strong> by controlling the impact of predictors that may otherwise dominate the model, particularly when dealing with multicollinearity or when the number of predictors is large compared to observations.</p>
<p>At higher levels of regularization (right side of the plot), the coefficients converge toward <strong>smaller absolute values</strong> but remain non-zero. This makes ridge regression especially <strong>useful for models with correlated predictors</strong>, as it ensures all variables contribute while maintaining the model’s <strong>robustness and prediction stability</strong>.</p>
</section>
<section id="cross-validation-to-search-optimal-lambda" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-to-search-optimal-lambda"><strong>2.2. Cross-validation to search optimal lambda</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cross validation ridge regression</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ridge_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> Y,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="dv">0</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type.measure =</span><span class="st">"mse"</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridge, <span class="at">main =</span> <span class="st">"Ridge penalty</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ridge_cv<span class="sc">$</span>lambda.min, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> ridge_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cross-validation-plot" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-plot"><strong>2.3. Cross-validation plot</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we will be using MSE to compare models </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ridge_cv, <span class="at">main =</span> <span class="st">"Ridge penalty</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cross-validation-results" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-results"><strong>2.4. Cross-validation results</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ridge_cv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:  cv.glmnet(x = X, y = Y, type.measure = "mse", alpha = 0) 

Measure: Mean-Squared Error 

    Lambda Index  Measure       SE Nonzero
min   0.01    95 0.005522 0.003249      16
1se  50.55     1 0.007160 0.003788      16</code></pre>
</div>
</div>
<p>The 10-fold cross-validation Mean Squared Error (MSE) for a ridge model is depicted in a plot. The first vertical dotted line indicates the value of λ that corresponds to the smallest MSE, while the second vertical line represents the λ value that is within one standard error of the minimum MSE.</p>
<p><strong>Minimum Lambda Found:</strong> 0.01</p>
<p>The crossvalidation gives us this optimized lambda values that allow us to yield the lowest Mean Squared Error, now we will use this value to predict using the training dataset.</p>
</section>
<section id="uses-the-minimum-lambda-to-predict-training-set" class="level3">
<h3 class="anchored" data-anchor-id="uses-the-minimum-lambda-to-predict-training-set"><strong>2.5. Uses the minimum lambda to predict training set</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using this crossvalidation</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ridge_cv_result <span class="ot">=</span> ridge_cv <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">newx =</span> X) <span class="sc">%&gt;%</span> <span class="fu">rowMeans</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(Y)<span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>ridge_cv_residuals <span class="ot">=</span> (Y <span class="sc">-</span> ridge_cv <span class="sc">%&gt;%</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">newx =</span> X))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((Y <span class="sc">-</span> <span class="fu">mean</span>(Y))<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># Total Sum of Squares</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>(ridge_cv_residuals<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Residual Sum of Squares</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>R_squared_ridgecv_train <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSR <span class="sc">/</span> SST)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>ridge_cv_result <span class="sc">%&gt;%</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> . , <span class="at">y =</span> Y)) <span class="sc">+</span> </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span>   </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_obs_pred</span>() <span class="sc">+</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">0.3</span>, <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"R-squared:"</span>, <span class="fu">round</span>(R_squared_ridgecv_train,<span class="dv">2</span>)))<span class="sc">+</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span> (<span class="st">"Predicted Poverty Headcount"</span>) <span class="sc">+</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span> (<span class="st">"Actual Poverty Headcount"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="elastic-net-to-find-the-optimal-tuning" class="level2">
<h2 class="anchored" data-anchor-id="elastic-net-to-find-the-optimal-tuning"><strong>3. Elastic net to find the optimal tuning</strong></h2>
<section id="cross-validation-plot-1" class="level3">
<h3 class="anchored" data-anchor-id="cross-validation-plot-1"><strong>3.1. Cross-validation plot</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grid search across </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cv_glmnet <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> Y,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"glmnet"</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#preProc = c("zv", "center", "scale"),</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">10</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot cross-validated RMSE</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cv_glmnet)<span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot visualizes which parameter yields the lowest RMSE in each of the 10 folds. Notice how the lambda has changes a bit, but allow us to use alpha of 0.2.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(cv_glmnet<span class="sc">$</span>bestTune, <span class="at">caption =</span> <span class="st">"*Grid seach result*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Grid seach result</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">alpha</th>
<th style="text-align: right;">lambda</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">0.0006651</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Alpha of 0.1 with lambda of 0.0006651 gives the lowest rmse.</p>
</section>
<section id="variable-importance-plot" class="level3">
<h3 class="anchored" data-anchor-id="variable-importance-plot"><strong>3.2. Variable Importance plot</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(cv_glmnet, <span class="at">bar =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="final-evaluation-of-ridge-and-elastic-net-model" class="level3">
<h3 class="anchored" data-anchor-id="final-evaluation-of-ridge-and-elastic-net-model"><strong>3.3 Final evaluation of ridge and elastic net model</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict Pov_headcount on training data</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>ridge_grid_result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pred =</span> <span class="fu">predict</span>(cv_glmnet, X),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fit =</span> df_train<span class="sc">$</span>Pov_headcount)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>ridge_grid_residuals <span class="ot">=</span> ridge_grid_result<span class="sc">$</span>pred <span class="sc">-</span> ridge_grid_result<span class="sc">$</span>fit</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compute RMSE of transformed predicted</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>rmse_grid <span class="ot">=</span> <span class="fu">RMSE</span>(ridge_grid_result<span class="sc">$</span>pred, ridge_grid_result<span class="sc">$</span>fit)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>mae_grid <span class="ot">=</span> <span class="fu">MAE</span>(ridge_grid_result<span class="sc">$</span>pred, ridge_grid_result<span class="sc">$</span>fit)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>mse_grid <span class="ot">=</span> <span class="fu">mean</span>((ridge_grid_residuals)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((Y <span class="sc">-</span> <span class="fu">mean</span>(Y))<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># Total Sum of Squares</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>SSR_grid <span class="ot">&lt;-</span> <span class="fu">sum</span>(ridge_grid_residuals<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Residual Sum of Squares</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>R_squared_gridsq_train <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSR_grid <span class="sc">/</span> SST)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>ridge_cv_grid_metrics <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"rmse"</span>,<span class="st">"rsq"</span>, <span class="st">"mae"</span>, <span class="st">"mse"</span>), </span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">elastic_train =</span> <span class="fu">c</span>(rmse_grid, </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>                       R_squared_gridsq_train, </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>                       mae_grid ,mse_grid))</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MAE</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>mae_cv_ridge <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ridge_cv_residuals))</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSE</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>mse_cv_ridge <span class="ot">&lt;-</span> <span class="fu">mean</span>((ridge_cv_residuals)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSE</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>rmse_cv_ridge <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse_cv_ridge)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MAE</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>mae_cv_ridge <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ridge_cv_residuals))</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSE</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>mse_cv_ridge <span class="ot">&lt;-</span> <span class="fu">mean</span>((ridge_cv_residuals)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSE</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>rmse_cv_ridge <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mse_cv_ridge)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>ridge_cv_metrics <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"rmse"</span>,<span class="st">"rsq"</span>, <span class="st">"mae"</span>, <span class="st">"mse"</span>), </span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">ridge_train =</span> <span class="fu">c</span>(rmse_cv_ridge, R_squared_ridgecv_train, mae_cv_ridge ,mse_cv_ridge)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>train_regular_metrics <span class="ot">=</span> ridge_cv_metrics <span class="sc">%&gt;%</span> </span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(ridge_cv_grid_metrics, <span class="at">by =</span> <span class="st">"metric"</span>)</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(train_regular_metrics,</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"*Ridge and Elastic net regressions training performance*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Ridge and Elastic net regressions training performance</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: right;">ridge_train</th>
<th style="text-align: right;">elastic_train</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rmse</td>
<td style="text-align: right;">0.0818711</td>
<td style="text-align: right;">0.0260620</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsq</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.8986660</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mae</td>
<td style="text-align: right;">0.0563644</td>
<td style="text-align: right;">0.0209360</td>
</tr>
<tr class="even">
<td style="text-align: left;">mse</td>
<td style="text-align: right;">0.0067029</td>
<td style="text-align: right;">0.0006792</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="prediction-and-evaluation-1" class="level2">
<h2 class="anchored" data-anchor-id="prediction-and-evaluation-1"><strong>4. Prediction and evaluation</strong></h2>
<section id="ridge-regression-and-elastic-results" class="level3">
<h3 class="anchored" data-anchor-id="ridge-regression-and-elastic-results"><strong>4.1. Ridge regression and Elastic results</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ridge_predict <span class="ot">=</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(ridge_cv, <span class="at">s=</span>ridge_cv<span class="sc">$</span>lambda<span class="fl">.1</span>se, <span class="at">newx =</span> X_test, <span class="at">lambda =</span> ridge_cv<span class="sc">$</span>lambda.min )</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>ridge_result <span class="ot">=</span><span class="fu">cbind</span>(ridge_predict, Y_test) <span class="sc">%&gt;%</span> </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>SST_r_test <span class="ot">&lt;-</span> <span class="fu">sum</span>((Y_test <span class="sc">-</span> <span class="fu">mean</span>(Y_test))<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># Total Sum of Squares</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>SSR_r_test<span class="ot">&lt;-</span> <span class="fu">sum</span>((Y_test <span class="sc">-</span> ridge_predict)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Residual Sum of Squares</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>R_squared_r_test <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ( SSR_r_test<span class="sc">/</span>SST_r_test)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>ridge_result0 <span class="ot">=</span> ridge_result <span class="sc">%&gt;%</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Pov_headcount =</span> Y_test,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">.pred =</span> s1,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">residuals =</span> Y_test <span class="sc">-</span> s1)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>ridge_plot <span class="ot">=</span> ridge_result0 <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> Pov_headcount)) <span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Predicted vs Actual Poverty Headcount"</span>, </span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="st">"Ridge Regression"</span>) <span class="sc">+</span>   </span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_obs_pred</span>()<span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Predicted Poverty Headcount"</span>)<span class="sc">+</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Actual Poverty Headcount"</span>)<span class="sc">+</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"R-squared:"</span>, </span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">round</span>(R_squared_r_test,<span class="dv">3</span>))) </span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>elastic_predict <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">pred =</span> <span class="fu">predict</span>(cv_glmnet, </span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">newdata =</span> X_test))</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>elastic_result <span class="ot">=</span><span class="fu">cbind</span>(elastic_predict, Y_test) <span class="sc">%&gt;%</span> </span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>SST_net_test <span class="ot">&lt;-</span> <span class="fu">sum</span>((Y_test <span class="sc">-</span> <span class="fu">mean</span>(Y_test))<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># Total Sum of Squares</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>SSR_net_test<span class="ot">&lt;-</span> <span class="fu">sum</span>((Y_test <span class="sc">-</span> elastic_predict)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Residual Sum of Squares</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>R_squared_net_test <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSR_net_test <span class="sc">/</span> SST_net_test)</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>elastic_result0 <span class="ot">=</span> elastic_result <span class="sc">%&gt;%</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">residuals =</span> Y_test <span class="sc">-</span> pred)</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>elastic_plot <span class="ot">=</span> elastic_result0 <span class="sc">%&gt;%</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pred, <span class="at">y =</span> Y_test)) <span class="sc">+</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Predicted vs Actual Poverty Headcounty"</span>, </span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="st">"Elastic net"</span>) <span class="sc">+</span>   </span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_obs_pred</span>()<span class="sc">+</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Predicted Poverty Headcount"</span>)<span class="sc">+</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Actual Poverty Headcount"</span>)<span class="sc">+</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"R-squared:"</span>, </span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">round</span>(R_squared_net_test,<span class="dv">3</span>))) </span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>ridge_plot<span class="sc">+</span>elastic_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="performance-metrics-of-testing-and-training" class="level3">
<h3 class="anchored" data-anchor-id="performance-metrics-of-testing-and-training"><strong>4.2 Performance Metrics of testing and training</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ridge------------</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>ridge_residuals <span class="ot">=</span> ridge_result[<span class="dv">1</span>] <span class="sc">-</span> ridge_result[<span class="dv">2</span>]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># compute RMSE of transformed predicted</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>rmse_ridge <span class="ot">=</span> <span class="fu">RMSE</span>(ridge_result<span class="sc">$</span>s1, ridge_result<span class="sc">$</span>Y_test)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>mae_ridge<span class="ot">=</span> <span class="fu">MAE</span>(ridge_result<span class="sc">$</span>s1,ridge_result<span class="sc">$</span>Y_test)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>mse_ridge <span class="ot">=</span> <span class="fu">mean</span>((ridge_residuals<span class="sc">$</span>s1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>SSR_ridge <span class="ot">&lt;-</span> <span class="fu">sum</span>(ridge_grid_residuals<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Residual Sum of Squares</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSE</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>ridge_metrics <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"rmse"</span>,<span class="st">"rsq"</span>, <span class="st">"mae"</span>, <span class="st">"mse"</span>), </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ridge_test =</span> <span class="fu">c</span>(rmse_ridge, </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                       R_squared_r_test, </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>                       mae_ridge ,mse_ridge))</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Elastic------------</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>elastic_residuals <span class="ot">=</span> elastic_result<span class="sc">$</span>pred <span class="sc">-</span> elastic_result<span class="sc">$</span>Y_test</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="co"># compute RMSE of transformed predicted</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>rmse_elastic <span class="ot">=</span> <span class="fu">RMSE</span>(elastic_result<span class="sc">$</span>pred , elastic_result<span class="sc">$</span>Y_test)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>mae_elastic <span class="ot">=</span> <span class="fu">MAE</span>(elastic_result<span class="sc">$</span>pred ,elastic_result<span class="sc">$</span>Y_test)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>mse_elastic <span class="ot">=</span> <span class="fu">mean</span>((elastic_residuals)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>SSR_elastic <span class="ot">&lt;-</span> <span class="fu">sum</span>(elastic_residuals<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Residual Sum of Squares</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate MSE</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>elastic_metrics <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">"rmse"</span>,<span class="st">"rsq"</span>, <span class="st">"mae"</span>, <span class="st">"mse"</span>), </span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">elastic_test =</span> <span class="fu">c</span>(rmse_elastic, </span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>                       R_squared_net_test, </span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>                       mae_elastic ,mse_elastic))</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>join_test_r <span class="ot">=</span> ridge_metrics <span class="sc">%&gt;%</span> <span class="fu">full_join</span>(elastic_metrics, <span class="at">by =</span> <span class="st">'metric'</span>) </span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>joined_metrics_r <span class="ot">=</span> train_regular_metrics <span class="sc">%&gt;%</span> </span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(join_test_r, <span class="at">by =</span> <span class="st">'metric'</span>)</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(joined_metrics_r,</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"*Ridge and Elastic net regression performance metrics*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption><em>Ridge and Elastic net regression performance metrics</em></caption>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: right;">ridge_train</th>
<th style="text-align: right;">elastic_train</th>
<th style="text-align: right;">ridge_test</th>
<th style="text-align: right;">elastic_test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rmse</td>
<td style="text-align: right;">0.0818711</td>
<td style="text-align: right;">0.0260620</td>
<td style="text-align: right;">0.0968168</td>
<td style="text-align: right;">0.0689615</td>
</tr>
<tr class="even">
<td style="text-align: left;">rsq</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.8986660</td>
<td style="text-align: right;">-0.0007150</td>
<td style="text-align: right;">0.4922827</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mae</td>
<td style="text-align: right;">0.0563644</td>
<td style="text-align: right;">0.0209360</td>
<td style="text-align: right;">0.0730258</td>
<td style="text-align: right;">0.0515822</td>
</tr>
<tr class="even">
<td style="text-align: left;">mse</td>
<td style="text-align: right;">0.0067029</td>
<td style="text-align: right;">0.0006792</td>
<td style="text-align: right;">0.0093735</td>
<td style="text-align: right;">0.0047557</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="residual-diagnostic-best-model" class="level3">
<h3 class="anchored" data-anchor-id="residual-diagnostic-best-model"><strong>4.3 Residual Diagnostic best model</strong></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>elastic_residuals_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">residuals =</span> elastic_residuals,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">Pov_headcount =</span> Y_test)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># form a residual histogram plot</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>histogram_test <span class="ot">=</span> <span class="fu">ggplot</span>(elastic_residuals_df, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histogram of Residuals"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(elastic_residuals_df<span class="sc">$</span>residuals), </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(elastic_residuals_df<span class="sc">$</span>residuals), </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>)<span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.17</span>, </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Mean: "</span>, <span class="fu">round</span>(<span class="fu">mean</span>(elastic_residuals_df<span class="sc">$</span>residuals),<span class="dv">2</span>)), </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"blue"</span> )<span class="sc">+</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,<span class="at">x =</span> <span class="fl">2.3</span>, <span class="at">y =</span> <span class="fl">0.20</span>, </span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Median: "</span>, <span class="fu">round</span>(<span class="fu">median</span>(elastic_residuals_df<span class="sc">$</span>residuals),<span class="dv">2</span>)), </span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"darkgreen"</span> )<span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="co"># lm model, uses ordinary least squares regession to fit a straight line</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>residual_fit <span class="ot">=</span> <span class="fu">ggplot</span>(elastic_residuals_df, <span class="fu">aes</span>(<span class="at">x =</span> Pov_headcount, <span class="at">y =</span> residuals))<span class="sc">+</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span><span class="st">"loess"</span>, <span class="at">color =</span> <span class="st">'red'</span>, <span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"fit vs residuals"</span>)</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>qq <span class="ot">=</span> <span class="fu">ggplot</span>(elastic_residuals_df, <span class="fu">aes</span>(<span class="at">sample =</span> residuals)) <span class="sc">+</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Q-Q Plot"</span>, <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>, <span class="at">y =</span> <span class="st">"Sample Quantiles"</span>)<span class="sc">+</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="co"># plot </span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>histogram_test <span class="sc">+</span> (qq<span class="sc">/</span>residual_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalassignment-script_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="model-comparison-and-conclusion" class="level1">
<h1><strong>Model Comparison and Conclusion</strong></h1>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">=</span> joined_metrics_r <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(joined_metrics_lm, <span class="at">by =</span> <span class="st">"metric"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span><span class="fu">rownames_to_column</span>() </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># transposed metrics</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(t1) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unlist</span>(t1[<span class="dv">1</span>, ]))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a> t1 <span class="ot">&lt;-</span>  t1[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span>rmse <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(t1<span class="sc">$</span>rmse)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span>rsq <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(t1<span class="sc">$</span>rsq)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span>mae <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(t1<span class="sc">$</span>mae)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span>mse <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(t1<span class="sc">$</span>mse)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>model_comparison <span class="ot">=</span> t1 <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(rmse)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(model_comparison, <span class="at">caption =</span> <span class="st">"All model's performance metric comparison"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>All model’s performance metric comparison</caption>
<thead>
<tr class="header">
<th style="text-align: left;">metric</th>
<th style="text-align: right;">rmse</th>
<th style="text-align: right;">rsq</th>
<th style="text-align: right;">mae</th>
<th style="text-align: right;">mse</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">elastic_train</td>
<td style="text-align: right;">0.0260620</td>
<td style="text-align: right;">0.8986660</td>
<td style="text-align: right;">0.0209360</td>
<td style="text-align: right;">0.0006792</td>
</tr>
<tr class="even">
<td style="text-align: left;">lm_train</td>
<td style="text-align: right;">0.0333120</td>
<td style="text-align: right;">0.8344454</td>
<td style="text-align: right;">0.0246942</td>
<td style="text-align: right;">0.0011097</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lm_testing</td>
<td style="text-align: right;">0.0610786</td>
<td style="text-align: right;">0.7363230</td>
<td style="text-align: right;">0.0461560</td>
<td style="text-align: right;">0.0037306</td>
</tr>
<tr class="even">
<td style="text-align: left;">elastic_test</td>
<td style="text-align: right;">0.0689615</td>
<td style="text-align: right;">0.4922827</td>
<td style="text-align: right;">0.0515822</td>
<td style="text-align: right;">0.0047557</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ridge_train</td>
<td style="text-align: right;">0.0818711</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0563644</td>
<td style="text-align: right;">0.0067029</td>
</tr>
<tr class="even">
<td style="text-align: left;">lm_crossvalidate</td>
<td style="text-align: right;">0.0922748</td>
<td style="text-align: right;">0.3970362</td>
<td style="text-align: right;">0.0643382</td>
<td style="text-align: right;">0.0145805</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ridge_test</td>
<td style="text-align: right;">0.0968168</td>
<td style="text-align: right;">-0.0007150</td>
<td style="text-align: right;">0.0730258</td>
<td style="text-align: right;">0.0093735</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="bestperforming-model" class="level1">
<h1><strong>Best–performing model</strong></h1>
<p>The <strong>Elastic Net model</strong> emerges as the best-performing model in this workflow. It strikes a <strong>balance between predictive accuracy and interpretability</strong> by addressing multicollinearity while retaining valuable predictors. In comparison, the <strong>multiple linear regression model</strong> serves as a strong baseline but suffers from overfitting and limitations due to collinearity. The <strong>Ridge regression model</strong> was less effective, suggesting it might not be suitable for this dataset’s structure. <strong>Cross-validation results</strong> reinforce the importance of regularization to improve generalizability.</p>
</section>
<section id="final-models-results-conclusion" class="level1">
<h1><strong>Final models results conclusion</strong></h1>
<ol type="1">
<li><strong>Multiple Linear Regression (lm)</strong><br>
The multiple linear regression model serves as a <strong>baseline</strong> to explore the relationships between predictors and the target variable. The <strong>training performance (R² = 0.834)</strong> shows a reasonably good fit with an RMSE of 0.0331, while the <strong>testing performance (R² = 0.736)</strong> indicates a decline, suggesting <strong>some overfitting</strong> on the training data. This model highlights the importance of initial predictors but is <strong>limited by multicollinearity</strong>, requiring careful adjustments to remove highly correlated variables. Despite being interpretable, <strong>performance trade-offs</strong> are visible, as indicated by the higher testing RMSE (0.0611).</li>
</ol>
<!-- -->
<ol start="2" type="1">
<li><strong>Elastic Net Regression</strong><br>
The Elastic Net model combines <strong>ridge and lasso penalties</strong> to address both multicollinearity and variable selection. It <strong>outperforms linear regression</strong>, with <strong>R² = 0.898</strong> and a <strong>lower RMSE (0.0261)</strong> on the training data, indicating <strong>improved predictive accuracy</strong>. On the testing set, its <strong>R² = 0.492</strong> and RMSE = 0.069 suggest a decrease in performance, yet it remains more reliable than the linear model for generalization. Elastic Net strikes a balance between <strong>retaining significant predictors</strong> and <strong>penalizing less important ones</strong>, ensuring an effective and interpretable model.</li>
</ol>
<!-- -->
<ol start="3" type="1">
<li><strong>Ridge Regression</strong><br>
The Ridge model focuses on <strong>shrinkage</strong> of coefficients to handle multicollinearity. However, its performance is relatively weak, with <strong>R² = 0.0</strong> on the training data, suggesting the coefficients were heavily penalized. On the testing set, the model’s <strong>R² = -0.0007</strong> and <strong>RMSE = 0.0968</strong> show poor generalization, indicating that the model struggles to capture the underlying relationships. While Ridge regression can prevent overfitting by shrinking coefficients, it may not always perform well when the true relationships are complex.</li>
</ol>
<section id="the-research-hypothesis-was-achieved" class="level2">
<h2 class="anchored" data-anchor-id="the-research-hypothesis-was-achieved">The Research Hypothesis was achieved?</h2>
<p>Yes, the research hypothesis was achieved. Overall the model was able predict the estimated poverty headcount with very high accuracy, indicating that the variables we used can deeply explain life expectancy. According to our results, GDP produced in agriculture sector that is considered the number of employees has the highest importance in VIP.</p>
</section>
<section id="proposed-solutions" class="level2">
<h2 class="anchored" data-anchor-id="proposed-solutions"><strong>Proposed Solutions</strong></h2>
<p>Investments in the <strong>agricultural sector</strong> should be prioritized to address poverty in rural areas, as agriculture remains the main source of livelihood for many poor communities. Governments can enhance agricultural productivity by improving access to modern technology, infrastructure, and training, while also incentivizing private sector investments through subsidies and tax breaks. Additionally, targeted <strong>employment programs</strong> and <strong>vocational training</strong> initiatives focused on modern farming practices can create job opportunities and empower farmers to increase their income. Strengthening <strong>public-private partnerships</strong> and international collaborations will further boost the sector by bringing in technical expertise and additional funding, ensuring sustainable agricultural development that benefits rural communities.</p>
<p>Beyond agriculture, <strong>diversifying rural economies</strong> is essential to ensure long-term poverty reduction.Expanding access to <strong>healthcare services</strong> and implementing <strong>social protection programs</strong>, such as cash transfers and agricultural subsidies, will help address income inequality and improve overall well-being. Governments should also adopt <strong>data-driven policy frameworks</strong>, leveraging predictive models like <strong>Elastic Net</strong> to monitor and adjust policies in real-time, ensuring effective poverty reduction efforts and sustainable growth.</p>
</section>
<section id="limitations" class="level2">
<h2 class="anchored" data-anchor-id="limitations">Limitations</h2>
<ul>
<li><strong>Lack of Data Availability:</strong> Poverty dataset has a lot of missing data, which might lead to the misunderstanding of the features. Also, the analysis relied on available data, which might not capture all relevant factors affecting poverty. Socioeconomic factors beyond GDP, like education or access to clean water,could be missing.</li>
</ul>
</section>
</section>
<section id="reference" class="level1">
<h1>Reference</h1>
<p>The World Bank. (2021). <em>Poverty and shared prosperity 2020: Reversals of fortune</em>. The World Bank. <a href="https://www.worldbank.org/en/publication/poverty-and-shared-prosperityestimate" class="uri">https://www.worldbank.org/en/publication/poverty-and-shared-prosperityestimate</a></p>
<p>The World Bank. (n.d.-a). <em>Manufacturing, value added (% of GDP)</em>. The World Bank Group. <a href="https://data.worldbank.org/indicator/NV.IND.MANF.ZS" class="uri">https://data.worldbank.org/indicator/NV.IND.MANF.ZS</a></p>
<p>The World Bank. (n.d.-b). <em>Services, value added (% of GDP)</em>. The World Bank Group. <a href="https://data.worldbank.org/indicator/NV.SRV.TOTL.ZS" class="uri">https://data.worldbank.org/indicator/NV.SRV.TOTL.ZS</a></p>
<p>The World Bank. (n.d.-c). <em>Industry (including construction), value added (% of GDP)</em>. The World Bank Group. <a href="https://data.worldbank.org/indicator/NV.IND.TOTL.ZS" class="uri">https://data.worldbank.org/indicator/NV.IND.TOTL.ZS</a></p>
<p>The World Bank. (n.d.-d). <em>Agriculture, forestry, and fishing, value added (% of GDP)</em>. The World Bank Group. <a href="https://data.worldbank.org/indicator/NV.AGR.TOTL.ZS" class="uri">https://data.worldbank.org/indicator/NV.AGR.TOTL.ZS</a></p>
<p>The World Bank. (n.d.-e). <em>GDP (current US$)</em>. The World Bank Group. <a href="https://data.worldbank.org/indicator/NY.GDP.MKTP.CD" class="uri">https://data.worldbank.org/indicator/NY.GDP.MKTP.CD</a></p>
<p>The World Bank. (n.d.-f). <em>Labor force participation rate, total (% of total population ages 15+) (modeled ILO estimate)</em>. The World Bank Group. <a href="https://data.worldbank.org/indicator/SL.TLF.ACTI.ZS" class="uri">https://data.worldbank.org/indicator/SL.TLF.ACTI.ZS</a></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>